<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Functions for gathering and processing tokenization data and for using ML models trained with such data.">

<title>markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification – trouver</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ebc57992554dae5230fa85c1bd5a55fa.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification – trouver">
<meta property="og:description" content="Functions for gathering and processing tokenization data and for using ML models trained with such data.">
<meta property="og:site_name" content="trouver">
<meta name="twitter:title" content="markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification – trouver">
<meta name="twitter:description" content="Functions for gathering and processing tokenization data and for using ML models trained with such data.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">trouver</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html">markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">trouver</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.__init__.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.__init__.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.vault.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.vault</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.markdown.file.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.markdown.file</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.markdown.heading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.markdown.heading</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.links.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.links</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.tags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.tags</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.footnotes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.footnotes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.__init__.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obisidian.personal</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.reference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obisidian.personal.reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obisidian.personal.authors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.authors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.index_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obisidian.personal.index_notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obisidian.personal.notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.note_type.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.note_type</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./latex.__init__.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">latex</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./latex.convert.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">latex.convert</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.machine_learning.__init__.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obisidian.personal.machine_learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.machine_learning.notations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obisidian.personal.machine_learning.notations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.note_processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obisidian.personal.note_processing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obisidian.personal.notation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.information_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.information_notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.machine_learninig.database_update.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obisidian.personal.machine_learning.database_update</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.machine_learning.information_note_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.machine_learning.information_note_types</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.machine_learning.notation_identification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obisidian.personal.machine_learning.notation_identification</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.machine_learning.notation_summarization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.machine_learning.notation_summarization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.machine_learning.tokenize.__init__.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.machine_learning.tokenize</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.vault.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.vault</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./latex.divide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">latex.divide</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./latex.folders.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">latex.folders</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./latex.formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">latex.formatting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./latex.preamble.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">latex.preamble</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.latex.comments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.latex.comments</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.machine_learning.notation_linking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.machine_learning.notation_linking</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.machine_learning.definition_and_notation_naming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.machine_learning.definition_and_notation_naming</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.regex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.regex</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.html.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.definition_and_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.definition_and_notation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.numbers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./41_helper.accented_characters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">41_helper.accented_characters.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.date_and_time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.date_and_time</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./43_helper.topological_sort.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Topological sort</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./44_helper.alphabet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alphabet</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.path_accepted_string.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.path_accepted_string</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./46_helper.files_and_folders.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Files and folders</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.latex</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.latex.macros_and_commands.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.latex.macros_and_commands</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.arxiv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.arxiv</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.vault_and_links.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.vault_and_links</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.notation.parse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.notation.parse</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.notation.in_standard_information_note.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.notation.in_standard_information_note</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.obsidian.personal.machine_learning.note_division.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">markdown.obsidian.personal.machine_learning.note_division</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app.__init__.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><code>app.__init__</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helper.packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.packages</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./todo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TODO list</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_to.install_trouver.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">how_to.install_trouver</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_to.train_ml_model.fastai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">how_to.train_ml_model.fastai</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./release_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">release_notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./star.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">helper.packages</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial.concise_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tutorial.concise_code</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial.walkthrough.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tutorial.walkthrough</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unused.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to use</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./using_regex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using Regex</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#gather-ml-data-from-information-notes" id="toc-gather-ml-data-from-information-notes" class="nav-link active" data-scroll-target="#gather-ml-data-from-information-notes">Gather ML data from information notes</a>
  <ul class="collapse">
  <li><a href="#convert_double_asterisks_to_html_tags" id="toc-convert_double_asterisks_to_html_tags" class="nav-link" data-scroll-target="#convert_double_asterisks_to_html_tags">convert_double_asterisks_to_html_tags</a></li>
  <li><a href="#raw_text_with_html_tags_from_markdownfile" id="toc-raw_text_with_html_tags_from_markdownfile" class="nav-link" data-scroll-target="#raw_text_with_html_tags_from_markdownfile">raw_text_with_html_tags_from_markdownfile</a></li>
  <li><a href="#html_data_from_note" id="toc-html_data_from_note" class="nav-link" data-scroll-target="#html_data_from_note">html_data_from_note</a></li>
  <li><a href="#def_or_notat_from_html_tag" id="toc-def_or_notat_from_html_tag" class="nav-link" data-scroll-target="#def_or_notat_from_html_tag">def_or_notat_from_html_tag</a></li>
  <li><a href="#tokenize_html_data" id="toc-tokenize_html_data" class="nav-link" data-scroll-target="#tokenize_html_data">tokenize_html_data</a></li>
  </ul></li>
  <li><a href="#gathering-data" id="toc-gathering-data" class="nav-link" data-scroll-target="#gathering-data">Gathering data</a></li>
  <li><a href="#use-the-trained-model" id="toc-use-the-trained-model" class="nav-link" data-scroll-target="#use-the-trained-model">Use the trained model</a>
  <ul class="collapse">
  <li><a href="#def_and_notat_preds_by_model" id="toc-def_and_notat_preds_by_model" class="nav-link" data-scroll-target="#def_and_notat_preds_by_model">def_and_notat_preds_by_model</a></li>
  <li><a href="#auto_mark_def_and_notats" id="toc-auto_mark_def_and_notats" class="nav-link" data-scroll-target="#auto_mark_def_and_notats">auto_mark_def_and_notats</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/hyunjongkimmath/trouver/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification</h1>
</div>

<div>
  <div class="description">
    Functions for gathering and processing tokenization data and for using ML models trained with such data.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>Previous, <code>trouver</code> just had functionalities for using ML models to identify newly introduced notations in text and for gathering data to train such models. Moreover, such models were merely classification models, and using these models to identify newly introduced notations had a lot of computational redundancies.</p>
<p>This module aims to provide the same functionalities for both definitions and notations by training and using token classification models instead.</p>
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Create a new module dedicated to definition and notation identification and move approparite functions over there.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> unittest <span class="im">import</span> mock</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datasets <span class="im">import</span> ClassLabel, Dataset, Features, Sequence, Value</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> AutoTokenizer</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastcore.test <span class="im">import</span> <span class="op">*</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> trouver.helper.tests <span class="im">import</span> _test_directory</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="gather-ml-data-from-information-notes" class="level2">
<h2 class="anchored" data-anchor-id="gather-ml-data-from-information-notes">Gather ML data from information notes</h2>
<hr>
<p><a href="https://github.com/hyunjongkimmath/trouver/blob/main/trouver/markdown/obsidian/personal/machine_learning/tokenize/def_and_notat_token_classification.py#L30" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="convert_double_asterisks_to_html_tags" class="level3">
<h3 class="anchored" data-anchor-id="convert_double_asterisks_to_html_tags">convert_double_asterisks_to_html_tags</h3>
<blockquote class="blockquote">
<pre><code> convert_double_asterisks_to_html_tags (text:str)</code></pre>
</blockquote>
<p><em>Replace the double asterisks, which signify definitions and notations, in <code>text</code> with HTML tags.</em></p>
<div id="cell-8" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(convert_double_asterisks_to_html_tags(<span class="st">"**hi**. Here is a notation **$asdf$**"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>test_eq(convert_double_asterisks_to_html_tags(<span class="st">"**hi**. Here is a notation **$asdf$**"</span>), <span class="st">'&lt;b definition=""&gt;hi&lt;/b&gt;. Here is a notation &lt;span notation=""&gt;$asdf$&lt;/span&gt;'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;b definition=""&gt;hi&lt;/b&gt;. Here is a notation &lt;span notation=""&gt;$asdf$&lt;/span&gt;</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/hyunjongkimmath/trouver/blob/main/trouver/markdown/obsidian/personal/machine_learning/tokenize/def_and_notat_token_classification.py#L62" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="raw_text_with_html_tags_from_markdownfile" class="level3">
<h3 class="anchored" data-anchor-id="raw_text_with_html_tags_from_markdownfile">raw_text_with_html_tags_from_markdownfile</h3>
<blockquote class="blockquote">
<pre><code> raw_text_with_html_tags_from_markdownfile
                                            (mf:trouver.markdown.markdown.
                                            file.MarkdownFile,
                                            vault:os.PathLike)</code></pre>
</blockquote>
<p><em>Process the <a href="https://hyunjongkimmath.github.io/trouver/markdown.markdown.file.html#markdownfile"><code>MarkdownFile</code></a>, replacing the double asterisk surrounded text indicating definitions and notations to be HTML tags instead.</em></p>
<p>In the following example, let <code>mf</code> be the following <a href="https://hyunjongkimmath.github.io/trouver/markdown.markdown.file.html#markdownfile"><code>MarkdownFile</code></a>:</p>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">str</span>(mf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>---
aliases: []
tags: []
---
# Galois group of a separable and normal finite field extension

Let $L/K$ be a separable and normal finite field extension. Its &lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt; &lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt; is...

# Galois group of a separable and normal profinite field extension

In fact, the notion of a Galois group can be defined for profinite field extensions. Given a separable and normal profinite field extension $L/K$, say that
$L = \varinjlim_i L_i$ where $L_i/K$ are finite extensions. Its **Galois group** **$\operatorname{Gal}(L/K)$**

# See Also
# Meta
## References and Citations</code></pre>
</div>
</div>
<p>The <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#raw_text_with_html_tags_from_markdownfile"><code>raw_text_with_html_tags_from_markdownfile</code></a> function processes the <a href="https://hyunjongkimmath.github.io/trouver/markdown.markdown.file.html#markdownfile"><code>MarkdownFile</code></a> much in the same way as the <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.note_processing.html#process_standard_information_note"><code>process_standard_information_note</code></a> function, except it 1. preserves HTML tags, and 2. replaces text surrounded by double asterisks <code>**</code> with HTML tags signifiying whether the text displays a definition or a notation.</p>
<p>In the below example, note that the <code>vault</code> parameter is set to <code>None</code>; this is fine for this example becaues the <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.note_processing.html#process_standard_information_note"><code>process_standard_information_note</code></a> function only needs a <code>vault</code> argument when embedded links need to be replaced with text (via the <a href="https://hyunjongkimmath.github.io/trouver/markdown.markdown.file.html#markdownfile.replace_embedded_links_with_text"><code>MarkdownFile.replace_embedded_links_with_text</code></a> function), but <code>mf</code> has no embedded links.</p>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(raw_text_with_html_tags_from_markdownfile(mf, <span class="va">None</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Let $L/K$ be a separable and normal finite field extension. Its &lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt; &lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt; is...

In fact, the notion of a Galois group can be defined for profinite field extensions. Given a separable and normal profinite field extension $L/K$, say that
$L = \varinjlim_i L_i$ where $L_i/K$ are finite extensions. Its &lt;b definition=""&gt;Galois group&lt;/b&gt; &lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;
</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/hyunjongkimmath/trouver/blob/main/trouver/markdown/obsidian/personal/machine_learning/tokenize/def_and_notat_token_classification.py#L78" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="html_data_from_note" class="level3">
<h3 class="anchored" data-anchor-id="html_data_from_note">html_data_from_note</h3>
<blockquote class="blockquote">
<pre><code> html_data_from_note (note_or_mf:Union[trouver.markdown.obsidian.vault.Vau
                      ltNote,trouver.markdown.markdown.file.MarkdownFile],
                      vault:Optional[os.PathLike]=None,
                      note_name:Optional[str]=None)</code></pre>
</blockquote>
<p>*Obtain html data for token classification from the information note.</p>
<p>Currently, the token types mainly revolve around definitions and notations.</p>
<p>If <code>note</code> has the tag <code>_auto/def_and_notat_identified</code>, then the data in the note is assumed to be auto-generated and not verified and <code>None</code> is returned.</p>
<p><strong>Returns</strong> - Union[dict, None] - The keys-value pairs are - <code>"Note name"</code> - The name of the note - <code>"Raw text"</code> - The raw text to include in the data. - <code>"Tag data"</code> - The list with HTML tags carrying definition/notation data and their locations in the Raw text. See the second output to the function <a href="https://hyunjongkimmath.github.io/trouver/helper.html.html#remove_html_tags_in_text"><code>remove_html_tags_in_text</code></a>. - Each element of the list is a tuple consisting of a <code>bs4.element.Tag</code> and two ints.*</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>note_or_mf</td>
<td>Union</td>
<td></td>
<td>Either a <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.vault.html#vaultnote"><code>VaultNote</code></a><code>object to a note or a [</code>MarkdownFile<code>](https://hyunjongkimmath.github.io/trouver/markdown.markdown.file.html#markdownfile) object from which to extra html data. | | vault | Optional | None | If vault to use when processing the [</code>MarkdownFile<code>](https://hyunjongkimmath.github.io/trouver/markdown.markdown.file.html#markdownfile) objects (if</code>note_of_mf<code>is a [</code>VaultNote<code>](https://hyunjongkimmath.github.io/trouver/markdown.obsidian.vault.html#vaultnote), then this [</code>MarkdownFile<code>](https://hyunjongkimmath.github.io/trouver/markdown.markdown.file.html#markdownfile) object is created from the text of the note), cf. the [</code>process_standard_information_note<code>](https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.note_processing.html#process_standard_information_note) function. | | note_name | Optional | None | If</code>note_or_mf<code>is a [</code>MarkdownFile<code>](https://hyunjongkimmath.github.io/trouver/markdown.markdown.file.html#markdownfile),</code>note_name<code>should be the name of the note from which the [</code>MarkdownFile<code>](https://hyunjongkimmath.github.io/trouver/markdown.markdown.file.html#markdownfile) comes from if applicable. If</code>note_or_mf<code>is a [</code>VaultNote<code>](https://hyunjongkimmath.github.io/trouver/markdown.obsidian.vault.html#vaultnote) object, then</code>note_name<code>is ignored and</code>note_or_mf.name<code>is used instead. | | **Returns** | **Optional** |  | **The keys to the dict are "Note name", "Raw text", "Tag data". However,</code>None<code>is returned if</code>note` does not exist or the note is marked with auto-generated, unverified data.**</td>
</tr>
</tbody>
</table>
<p>In the following example, we mock a <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.vault.html#vaultnote"><code>VaultNote</code></a> whose content is that of <code>mf</code> in the example for the <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#raw_text_with_html_tags_from_markdownfile"><code>raw_text_with_html_tags_from_markdownfile</code></a> function. Note that there is some text surrounded by double within <code>mf</code> surrounded by double asterisks <code>**</code> and some text surrounded by HTML tags to indicate definitions and notations introduced.</p>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mf <span class="op">=</span> MarkdownFile.from_string(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"""---</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="vs">aliases: []</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="vs">tags: []</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="vs">---</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="vs"># Galois group of a separable and normal finite field extension</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="vs">Let $L/K$ be a separable and normal finite field extension. Its &lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt; &lt;span notation=""&gt;$\operatorname</span><span class="sc">{Gal}</span><span class="vs">(L/K)$&lt;/span&gt; is...</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="vs"># Galois group of a separable and normal profinite field extension</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="vs">In fact, the notion of a Galois group can be defined for profinite field extensions. Given a separable and normal profinite field extension $L/K$, say that</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="vs">$L = \varinjlim_i L_i$ where $L_i/K$ are finite extensions. Its **Galois group** **$\operatorname</span><span class="sc">{Gal}</span><span class="vs">(L/K)$**</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="vs"># See Also</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="vs"># Meta</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="vs">## References and Citations</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="vs">"""</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> (mock.patch(<span class="st">'__main__.VaultNote'</span>) <span class="im">as</span> mock_VaultNote,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      mock.patch(<span class="st">'__main__.MarkdownFile.from_vault_note'</span>) <span class="im">as</span> mock_from_vault_note,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      mock.patch(<span class="st">'__main__.isinstance'</span>) <span class="im">as</span> mock_isinstance):</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    mock_VaultNote.exists.return_value <span class="op">=</span> <span class="va">True</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    mock_VaultNote.name <span class="op">=</span> <span class="st">"Note's name"</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    mock_from_vault_note.return_value <span class="op">=</span> mf</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    mock_isinstance.return_value <span class="op">=</span> <span class="va">True</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"The following is the text from mf:</span><span class="ch">\n\n</span><span class="sc">{</span><span class="bu">str</span>(mf)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    html_data <span class="op">=</span> html_data_from_note(mock_VaultNote, <span class="va">None</span>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(html_data)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    test_eq(html_data[<span class="st">'Note name'</span>], <span class="st">"Note's name"</span>)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">'**'</span> <span class="kw">not</span> <span class="kw">in</span> html_data[<span class="st">'Raw text'</span>]</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="st">'&lt;'</span> <span class="kw">not</span> <span class="kw">in</span> html_data[<span class="st">'Raw text'</span>]  <span class="co"># Test the lack of HTML tags in the raw text</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(html_data[<span class="st">'Tag data'</span>])</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    test_eq(<span class="bu">len</span>(html_data[<span class="st">'Tag data'</span>]), <span class="dv">4</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="bu">isinstance</span>(html_data[<span class="st">'Tag data'</span>][<span class="dv">0</span>][<span class="dv">0</span>], bs4.element.Tag)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">0</span>][<span class="dv">0</span>].has_attr(<span class="st">'definition'</span>)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="kw">not</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">0</span>][<span class="dv">0</span>].has_attr(<span class="st">'notation'</span>)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">1</span>][<span class="dv">0</span>].has_attr(<span class="st">'notation'</span>)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="kw">not</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">1</span>][<span class="dv">0</span>].has_attr(<span class="st">'definition'</span>)</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">2</span>][<span class="dv">0</span>].has_attr(<span class="st">'definition'</span>)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="kw">not</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">2</span>][<span class="dv">0</span>].has_attr(<span class="st">'notation'</span>)</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">3</span>][<span class="dv">0</span>].has_attr(<span class="st">'notation'</span>)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="kw">not</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">3</span>][<span class="dv">0</span>].has_attr(<span class="st">'definition'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following is the text from mf:

---
aliases: []
tags: []
---
# Galois group of a separable and normal finite field extension

Let $L/K$ be a separable and normal finite field extension. Its &lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt; &lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt; is...

# Galois group of a separable and normal profinite field extension

In fact, the notion of a Galois group can be defined for profinite field extensions. Given a separable and normal profinite field extension $L/K$, say that
$L = \varinjlim_i L_i$ where $L_i/K$ are finite extensions. Its **Galois group** **$\operatorname{Gal}(L/K)$**

# See Also
# Meta
## References and Citations
{'Note name': "Note's name", 'Raw text': 'Let $L/K$ be a separable and normal finite field extension. Its Galois group $\\operatorname{Gal}(L/K)$ is...\n\nIn fact, the notion of a Galois group can be defined for profinite field extensions. Given a separable and normal profinite field extension $L/K$, say that\n$L = \\varinjlim_i L_i$ where $L_i/K$ are finite extensions. Its Galois group $\\operatorname{Gal}(L/K)$\n', 'Tag data': [(&lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt;, 64, 76), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 77, 102), (&lt;b definition=""&gt;Galois group&lt;/b&gt;, 330, 342), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 343, 368)]}
[(&lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt;, 64, 76), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 77, 102), (&lt;b definition=""&gt;Galois group&lt;/b&gt;, 330, 342), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 343, 368)]</code></pre>
</div>
</div>
<p>We can also just pass a <code>MarkdonwFile</code> object instead of a <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.vault.html#vaultnote"><code>VaultNote</code></a> object. In this case, we can specify the <code>note_name</code> parameter to indicate which note the <a href="https://hyunjongkimmath.github.io/trouver/markdown.markdown.file.html#markdownfile"><code>MarkdownFile</code></a> object came from, if applicable.</p>
<div id="cell-18" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>html_data <span class="op">=</span> html_data_from_note(mf, vault<span class="op">=</span><span class="va">None</span>, note_name<span class="op">=</span><span class="st">"Note's name"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(html_data)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>test_eq(html_data[<span class="st">'Note name'</span>], <span class="st">"Note's name"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="st">'**'</span> <span class="kw">not</span> <span class="kw">in</span> html_data[<span class="st">'Raw text'</span>]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="st">'&lt;'</span> <span class="kw">not</span> <span class="kw">in</span> html_data[<span class="st">'Raw text'</span>]  <span class="co"># Test the lack of HTML tags in the raw text</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(html_data[<span class="st">'Tag data'</span>])</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(html_data[<span class="st">'Tag data'</span>]), <span class="dv">4</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">isinstance</span>(html_data[<span class="st">'Tag data'</span>][<span class="dv">0</span>][<span class="dv">0</span>], bs4.element.Tag)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">0</span>][<span class="dv">0</span>].has_attr(<span class="st">'definition'</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="kw">not</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">0</span>][<span class="dv">0</span>].has_attr(<span class="st">'notation'</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">1</span>][<span class="dv">0</span>].has_attr(<span class="st">'notation'</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="kw">not</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">1</span>][<span class="dv">0</span>].has_attr(<span class="st">'definition'</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">2</span>][<span class="dv">0</span>].has_attr(<span class="st">'definition'</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="kw">not</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">2</span>][<span class="dv">0</span>].has_attr(<span class="st">'notation'</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">3</span>][<span class="dv">0</span>].has_attr(<span class="st">'notation'</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="kw">not</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">3</span>][<span class="dv">0</span>].has_attr(<span class="st">'definition'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'Note name': "Note's name", 'Raw text': 'Let $L/K$ be a separable and normal finite field extension. Its Galois group $\\operatorname{Gal}(L/K)$ is...\n\nIn fact, the notion of a Galois group can be defined for profinite field extensions. Given a separable and normal profinite field extension $L/K$, say that\n$L = \\varinjlim_i L_i$ where $L_i/K$ are finite extensions. Its Galois group $\\operatorname{Gal}(L/K)$\n', 'Tag data': [(&lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt;, 64, 76), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 77, 102), (&lt;b definition=""&gt;Galois group&lt;/b&gt;, 330, 342), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 343, 368)]}
[(&lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt;, 64, 76), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 77, 102), (&lt;b definition=""&gt;Galois group&lt;/b&gt;, 330, 342), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 343, 368)]</code></pre>
</div>
</div>
<p>If we do not specify <code>note_name</code>, then <code>None</code> is used for the <code>'Note name'</code> key in the output:</p>
<div id="cell-20" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>html_data <span class="op">=</span> html_data_from_note(mf, vault<span class="op">=</span><span class="va">None</span>, note_name<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(html_data)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> html_data[<span class="st">'Note name'</span>] <span class="kw">is</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'Note name': None, 'Raw text': 'Let $L/K$ be a separable and normal finite field extension. Its Galois group $\\operatorname{Gal}(L/K)$ is...\n\nIn fact, the notion of a Galois group can be defined for profinite field extensions. Given a separable and normal profinite field extension $L/K$, say that\n$L = \\varinjlim_i L_i$ where $L_i/K$ are finite extensions. Its Galois group $\\operatorname{Gal}(L/K)$\n', 'Tag data': [(&lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt;, 64, 76), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 77, 102), (&lt;b definition=""&gt;Galois group&lt;/b&gt;, 330, 342), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 343, 368)]}</code></pre>
</div>
</div>
<p>For the following example, the note has an HTML tag already with extra data (attributes other than <code>'definition'</code> or <code>'notation'</code>). We assert that the extra data is preserved.</p>
<div id="cell-22" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> (mock.patch(<span class="st">'__main__.VaultNote'</span>) <span class="im">as</span> mock_VaultNote,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>      mock.patch(<span class="st">'__main__.MarkdownFile.from_vault_note'</span>) <span class="im">as</span> mock_from_vault_note,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>      mock.patch(<span class="st">'__main__.isinstance'</span>) <span class="im">as</span> mock_isinstance):</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    mock_VaultNote.exists.return_value <span class="op">=</span> <span class="va">True</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    mock_VaultNote.name <span class="op">=</span> <span class="st">"Note's name"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    mock_isinstance.return_value <span class="op">=</span> <span class="va">True</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">'Let $X$ be a topological space and let $U \subseteq X$ be an subspace. The &lt;b definition="Closure of a subspace of a topological space" typo="dosure of $U$"&gt;closure of $U$&lt;/b&gt; is defined as...'</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    mf <span class="op">=</span> MarkdownFile.from_string(text)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    mock_from_vault_note.return_value <span class="op">=</span> mf</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"The following is the text of the mocked note: </span><span class="ch">\n\n</span><span class="ss"> </span><span class="sc">{</span>text<span class="sc">}</span><span class="ch">\n\n</span><span class="ss">"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    html_data <span class="op">=</span> html_data_from_note(mock_VaultNote, <span class="va">None</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(html_data)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> html_data[<span class="st">'Tag data'</span>][<span class="dv">0</span>][<span class="dv">0</span>].has_attr(<span class="st">'typo'</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    test_eq(html_data[<span class="st">'Tag data'</span>][<span class="dv">0</span>][<span class="dv">0</span>].attrs[<span class="st">'typo'</span>], <span class="st">'dosure of $U$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following is the text of the mocked note: 

 Let $X$ be a topological space and let $U \subseteq X$ be an subspace. The &lt;b definition="Closure of a subspace of a topological space" typo="dosure of $U$"&gt;closure of $U$&lt;/b&gt; is defined as...


{'Note name': "Note's name", 'Raw text': 'Let $X$ be a topological space and let $U \\subseteq X$ be an subspace. The closure of $U$ is defined as...', 'Tag data': [(&lt;b definition="Closure of a subspace of a topological space" typo="dosure of $U$"&gt;closure of $U$&lt;/b&gt;, 75, 89)]}</code></pre>
</div>
</div>
<p>In the following example, the (mocked) note has the <code>#_auto/def_and_notats_identified</code> tag to indicate that its definition and notation markings were auto-generated by a model (trained with data processed by the <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#tokenize_html_data"><code>tokenize_html_data</code></a> function) using the <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#auto_mark_def_and_notats"><code>auto_mark_def_and_notats</code></a> function. In this case, the <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#html_data_from_note"><code>html_data_from_note</code></a> function returns <code>None</code> to prevent gathering data that is unverified and auto-generated by a model.</p>
<div id="cell-24" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with (mock.patch('__main__.VaultNote') as mock_VaultNote,</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#       mock.patch('__main__.MarkdownFile.from_vault_note') as mock_from_vault_note):</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     mock_VaultNote.exists.return_value = True</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     mock_VaultNote.name = "Note's name"</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="vs">r'''---</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="vs">tags: [_auto/def_and_notat_identified]</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="vs">---</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="vs">Let $X$ be a topological space and let $U \subseteq X$ be an subspace. The &lt;b definition="Closure of a subspace of a topological space" typo="dosure of $U$"&gt;closure of $U$&lt;/b&gt; is defined as...'''</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>mf <span class="op">=</span> MarkdownFile.from_string(text)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>mock_from_vault_note.return_value <span class="op">=</span> mf</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The following is the text of the mocked note: </span><span class="ch">\n\n</span><span class="sc">{</span>text<span class="sc">}</span><span class="ch">\n\n</span><span class="ss">"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>html_data <span class="op">=</span> html_data_from_note(note_or_mf<span class="op">=</span>mf)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span>(html_data <span class="kw">is</span> <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following is the text of the mocked note: 

---
tags: [_auto/def_and_notat_identified]
---
Let $X$ be a topological space and let $U \subseteq X$ be an subspace. The &lt;b definition="Closure of a subspace of a topological space" typo="dosure of $U$"&gt;closure of $U$&lt;/b&gt; is defined as...

</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/hyunjongkimmath/trouver/blob/main/trouver/markdown/obsidian/personal/machine_learning/tokenize/def_and_notat_token_classification.py#L270" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="def_or_notat_from_html_tag" class="level3">
<h3 class="anchored" data-anchor-id="def_or_notat_from_html_tag">def_or_notat_from_html_tag</h3>
<blockquote class="blockquote">
<pre><code> def_or_notat_from_html_tag (tag:bs4.element.Tag)</code></pre>
</blockquote>
<p>*Can be passed as the <code>ner_tag_from_html_tag</code> argument in <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#tokenize_html_data"><code>tokenize_html_data</code></a> for the purposes of compiling a dataset for definition and notation identification.</p>
<p>The strings f”I-{output}” and f”B-{output}” are valid ner_tags. To use for*</p>
<hr>
<p><a href="https://github.com/hyunjongkimmath/trouver/blob/main/trouver/markdown/obsidian/personal/machine_learning/tokenize/def_and_notat_token_classification.py#L123" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="tokenize_html_data" class="level3">
<h3 class="anchored" data-anchor-id="tokenize_html_data">tokenize_html_data</h3>
<blockquote class="blockquote">
<pre><code> tokenize_html_data (html_locus:dict, tokenizer:Union[transformers.tokeniz
                     ation_utils.PreTrainedTokenizer,transformers.tokeniza
                     tion_utils_fast.PreTrainedTokenizerFast],
                     max_length:int, ner_tag_from_html_tag:&lt;built-
                     infunctioncallable&gt;, label2id:dict[str,int],
                     default_label:str='O')</code></pre>
</blockquote>
<p>*Actually tokenize the html data outputted by <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#html_data_from_note"><code>html_data_from_note</code></a>.</p>
<p>To account for the possibility that the raw text is long, this function uses the <code>tokenizer.batch_encode_plus</code> function to tokenize the text into sequences.*</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>html_locus</td>
<td>dict</td>
<td></td>
<td>An output of <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#html_data_from_note"><code>html_data_from_note</code></a></td>
</tr>
<tr class="even">
<td>tokenizer</td>
<td>Union</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>max_length</td>
<td>int</td>
<td></td>
<td>Max length for each sequence of tokens</td>
</tr>
<tr class="even">
<td>ner_tag_from_html_tag</td>
<td>callable</td>
<td></td>
<td>takes in a bs4.element.Tag and outputs the ner_tag (as a string or <code>None</code>)</td>
</tr>
<tr class="odd">
<td>label2id</td>
<td>dict</td>
<td></td>
<td>The keys ner_tag’s of the form f”I-{output}” or f”B-{output}” where <code>output</code> is an output of <code>ner_tag_from_html_tag</code>.</td>
</tr>
<tr class="even">
<td>default_label</td>
<td>str</td>
<td>O</td>
<td>The default label for the NER tagging.</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>tuple</strong></td>
<td></td>
<td><strong>The first list consists of the tokens and the second list consists of the named entity recognition tags.</strong></td>
</tr>
</tbody>
</table>
<p>We continue with an example using the HTML data from the example for the <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#html_data_from_note"><code>html_data_from_note</code></a> function.</p>
<div id="cell-28" class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mf <span class="op">=</span> MarkdownFile.from_string(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"""---</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="vs">aliases: []</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="vs">tags: []</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="vs">---</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="vs"># Galois group of a separable and normal finite field extension</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="vs">Let $L/K$ be a separable and normal finite field extension. Its &lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt; &lt;span notation=""&gt;$\operatorname</span><span class="sc">{Gal}</span><span class="vs">(L/K)$&lt;/span&gt; is...</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="vs"># Galois group of a separable and normal profinite field extension</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="vs">In fact, the notion of a Galois group can be defined for profinite field extensions. Given a separable and normal profinite field extension $L/K$, say that</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="vs">$L = \varinjlim_i L_i$ where $L_i/K$ are finite extensions. Its **Galois group** **$\operatorname</span><span class="sc">{Gal}</span><span class="vs">(L/K)$**</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="vs"># See Also</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="vs"># Meta</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="vs">## References and Citations</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="vs">"""</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>html_data <span class="op">=</span> html_data_from_note(mf, vault<span class="op">=</span><span class="va">None</span>, note_name<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(html_data)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co"># assert html_data['Note name'] is None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'Note name': None, 'Raw text': 'Let $L/K$ be a separable and normal finite field extension. Its Galois group $\\operatorname{Gal}(L/K)$ is...\n\nIn fact, the notion of a Galois group can be defined for profinite field extensions. Given a separable and normal profinite field extension $L/K$, say that\n$L = \\varinjlim_i L_i$ where $L_i/K$ are finite extensions. Its Galois group $\\operatorname{Gal}(L/K)$\n', 'Tag data': [(&lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt;, 64, 76), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 77, 102), (&lt;b definition=""&gt;Galois group&lt;/b&gt;, 330, 342), (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 343, 368)]}</code></pre>
</div>
</div>
<div id="cell-29" class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>html_data[<span class="st">'Raw text'</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>html_data[<span class="st">"Tag data"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[(&lt;b definition="Galois group of a separable and normal finite field extension"&gt;Galois group&lt;/b&gt;,
  64,
  76),
 (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 77, 102),
 (&lt;b definition=""&gt;Galois group&lt;/b&gt;, 330, 342),
 (&lt;span notation=""&gt;$\operatorname{Gal}(L/K)$&lt;/span&gt;, 343, 368)]</code></pre>
</div>
</div>
<div id="cell-30" class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> AutoTokenizer.from_pretrained(<span class="st">"distilbert-base-uncased"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>c:\Users\hyunj\Documents\Development\Python\trouver_py310_venv\lib\site-packages\transformers\tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(</code></pre>
</div>
</div>
<div id="cell-31" class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>label2id <span class="op">=</span> {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"O"</span>: <span class="dv">0</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"B-definition"</span>: <span class="dv">1</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I-definition"</span>: <span class="dv">2</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"B-notation"</span>: <span class="dv">3</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I-notation"</span>: <span class="dv">4</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>tokens, ner_tag_ids <span class="op">=</span> tokenize_html_data(html_data, tokenizer, <span class="dv">510</span>, def_or_notat_from_html_tag, label2id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For this example, <code>max_length</code> is set to 510 (tokens). The string (“Raw text”) is not very long, so only one sequence should be present.</p>
<div id="cell-33" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(tokens), <span class="dv">1</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(ner_tag_ids), <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let us see what has been tagged:</p>
<div id="cell-35" class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>id2label <span class="op">=</span> {value: key <span class="cf">for</span> key, value <span class="kw">in</span> label2id.items()}</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>id2label</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{0: 'O',
 1: 'B-definition',
 2: 'I-definition',
 3: 'B-notation',
 4: 'I-notation'}</code></pre>
</div>
</div>
<div id="cell-36" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> token, ner_tag <span class="kw">in</span> <span class="bu">zip</span>(tokens[<span class="dv">0</span>], ner_tag_ids[<span class="dv">0</span>]):</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ner_tag <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>token<span class="sc">}</span><span class="ch">\t\t</span><span class="sc">{</span>id2label[ner_tag]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gal     B-definition
##ois       I-definition
group       I-definition
$       B-notation
\       I-notation
operator        I-notation
##name      I-notation
{       I-notation
gal     I-notation
}       I-notation
(       I-notation
l       I-notation
/       I-notation
k       I-notation
)       I-notation
$       I-notation
gal     B-definition
##ois       I-definition
group       I-definition
$       B-notation
\       I-notation
operator        I-notation
##name      I-notation
{       I-notation
gal     I-notation
}       I-notation
(       I-notation
l       I-notation
/       I-notation
k       I-notation
)       I-notation
$       I-notation</code></pre>
</div>
</div>
<p>Let us set <code>max_length</code> to be shorter to observe an example of a tokenization of a single text across multiple sequences (Of course, in practice, the max token length would be set to be longer, say around 512 or 1024.):</p>
<div id="cell-38" class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>token_ids, ner_tag_ids <span class="op">=</span> tokenize_html_data(html_data, tokenizer, <span class="dv">20</span>, def_or_notat_from_html_tag, label2id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-39" class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(token_ids))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(ner_tag_ids))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>7
7</code></pre>
</div>
</div>
<div id="cell-40" class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ner_tag_ids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2],
 [2, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 3, 4, 4],
 [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0]]</code></pre>
</div>
</div>
</section>
</section>
<section id="gathering-data" class="level2">
<h2 class="anchored" data-anchor-id="gathering-data">Gathering data</h2>
<p>The following is sample code to then gather data for definition/notation identification</p>
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: test</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>notes <span class="op">=</span> [] <span class="co"># Replace with actual notes</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>vault <span class="op">=</span> <span class="st">''</span> <span class="co"># Replace with actual vault</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vault = 'C:' # Replace with actual vault</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># notes = [] # Replace with actual notes</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>html_data <span class="op">=</span> [html_data_from_note(note, vault) <span class="cf">for</span> note <span class="kw">in</span> notes]</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>max_length <span class="op">=</span> <span class="dv">1022</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>tokenized_html_data <span class="op">=</span> [tokenize_html_data(html_locus, tokenizer, max_length, def_or_notat_from_html_tag, label2id) <span class="cf">for</span> html_locus <span class="kw">in</span> html_data]</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>token_id_data <span class="op">=</span> [token_ids <span class="cf">for</span> token_ids, _ <span class="kw">in</span> tokenized_html_data]</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>ner_tag_data <span class="op">=</span> [ner_tag_ids <span class="cf">for</span> _, ner_tag_ids <span class="kw">in</span> tokenized_html_data]</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>token_seqs <span class="op">=</span> [token_seq <span class="cf">for</span> token_seq <span class="kw">in</span> token_ids <span class="cf">for</span> token_ids <span class="kw">in</span> token_id_data]</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>ner_tag_seqs <span class="op">=</span> [ner_tag_seq <span class="cf">for</span> ner_tag_seq <span class="kw">in</span> ner_tag_ids <span class="cf">for</span> ner_tag_ids <span class="kw">in</span> ner_tag_data]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-44" class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> AutoTokenizer.from_pretrained(<span class="st">"distilbert-base-uncased"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>max_length <span class="op">=</span> <span class="dv">1022</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>label2id <span class="op">=</span> {</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"O"</span>: <span class="dv">0</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"B-definition"</span>: <span class="dv">1</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I-definition"</span>: <span class="dv">2</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"B-notation"</span>: <span class="dv">3</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I-notation"</span>: <span class="dv">4</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>id2label <span class="op">=</span> {value: key <span class="cf">for</span> key, value <span class="kw">in</span> label2id.items()}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-45" class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>note_names, token_seqs, ner_tag_seqs <span class="op">=</span> [], [], []</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> html_locus, (token_ids, ner_tag_ids) <span class="kw">in</span> <span class="bu">zip</span>(html_data, tokenized_html_data):</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    note_names.extend([html_locus[<span class="st">"Note name"</span>]] <span class="op">*</span> <span class="bu">len</span>(token_ids))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    token_seqs.extend(token_ids)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    ner_tag_seqs.extend(ner_tag_ids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-46" class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ner_tags = ClassLabel(names=list(label2id))</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ds = Dataset.from_dict(</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">#         {"note_name": note_names,</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co">#         "tokens": token_ids,</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co">#         "ner_tags": ner_tag_ids},</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co">#         features=Features(</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">#             {</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              "note_name": Value(dtype='string'),</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              "tokens": Sequence(Value(dtype='string')),</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              "ner_tags": Sequence(ner_tags)}</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co">#         ))</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ds.save_to_disk(".")</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ds.load_from_disk(".")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="use-the-trained-model" class="level2">
<h2 class="anchored" data-anchor-id="use-the-trained-model">Use the trained model</h2>
<p>See https://huggingface.co/docs/transformers/tasks/token_classification for training a token classification model.</p>
<div id="cell-49" class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper functions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-50" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>soup <span class="op">=</span> bs4.BeautifulSoup(<span class="st">''</span>, <span class="st">'html.parser'</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>tag <span class="op">=</span> soup.new_tag(<span class="st">'b'</span>, style<span class="op">=</span><span class="st">"border-width:1px;border-style:solid;padding:3px"</span>, definition<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>tag.string <span class="op">=</span> <span class="st">'hi'</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>tag</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;b definition="" style="border-width:1px;border-style:solid;padding:3px"&gt;hi&lt;/b&gt;</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/hyunjongkimmath/trouver/blob/main/trouver/markdown/obsidian/personal/machine_learning/tokenize/def_and_notat_token_classification.py#L729" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="def_and_notat_preds_by_model" class="level3">
<h3 class="anchored" data-anchor-id="def_and_notat_preds_by_model">def_and_notat_preds_by_model</h3>
<blockquote class="blockquote">
<pre><code> def_and_notat_preds_by_model (text:str, pipeline)</code></pre>
</blockquote>
<p>*Predict where definitions and notations occur in <code>text</code></p>
<p>This function uses some of the same helper functions as <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#auto_mark_def_and_notats"><code>auto_mark_def_and_notats</code></a>, but does not raise warning messages as in <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#auto_mark_def_and_notats"><code>auto_mark_def_and_notats</code></a>.*</p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>text</td>
<td>str</td>
<td></td>
</tr>
<tr class="even">
<td>pipeline</td>
<td></td>
<td>The pipeline object created using the token classification model and its tokenizer</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>list</strong></td>
<td><strong>Each tuple consists of an HTML tag carrying the data of the prediction and ints marking where in <code>text</code> the definition or notation is at.</strong></td>
</tr>
</tbody>
</table>
<div id="cell-52" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/hyunjongkimmath/trouver/blob/main/trouver/markdown/obsidian/personal/machine_learning/tokenize/def_and_notat_token_classification.py#L744" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="auto_mark_def_and_notats" class="level3">
<h3 class="anchored" data-anchor-id="auto_mark_def_and_notats">auto_mark_def_and_notats</h3>
<blockquote class="blockquote">
<pre><code> auto_mark_def_and_notats (note:trouver.markdown.obsidian.vault.VaultNote,
                           pipeline:transformers.pipelines.token_classific
                           ation.TokenClassificationPipeline,
                           excessive_space_threshold:int=2, add_boxing_att
                           r_to_existing_def_and_notat_markings:bool=True)</code></pre>
</blockquote>
<p>*Predict and mark where definitions and notation occur in a note using a token classification ML model.</p>
<p>Assumes that the note is a standard information note that does not have a lot of “user modifications”, such as footnotes, links, and HTML tags. If there are many modifications, then these might be deleted.</p>
<p>Assumes that the paragraphs in the text of the note are “not too long”. Currently, this means that the paragraphs in the number of tokens in the text of the note should (roughly) not exceed <code>pipeline.tokenizer.model_max_length</code>.</p>
<p>Existing markings for definition and notation data (i.e.&nbsp;by surrounding with double asterisks or by HTML tags) are preserved (and turned into HTML tags), unless the markings overlap with predictions, in which case the original is preserved (and still turned into an HTML tag if possible)</p>
<p>Since the model can make “invalid” predictions (mostly those which start or end within a LaTeX math mode str), the actual markings are not necessarily direct translates from the model’s predictions. See the helper function <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#_consolidate_token_preds"><code>_consolidate_token_preds</code></a> for more details on how this is implemented.</p>
<p><strong>Raises</strong> Warning messages (<code>UserWarning</code>) are printed in the following situations:</p>
<ul>
<li>There are two consecutive tokens within the <code>pipeline</code>’s predictions of different entity types (e.g.&nbsp;one is predicted to belong within a definition and the other within a notation), but the latter token’s predicted <code>'entity'</code> more specifically begins with <code>'I-'</code> (i.e.&nbsp;is <code>'I-definition'</code> or <code>'I-notation'</code>) as opposed to <code>'B-'</code>.
<ul>
<li><code>note</code>’s name, and path are included in the warning message in this case.</li>
</ul></li>
<li>There are two consecutive tokens within the <code>pipeline</code>’s predictions which the pipeline predicts to belong to the same entity, and yet there is excessive space (specified by <code>excessive_space_threshold</code>) between the end of the first token and the start of the second.*</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>note</td>
<td>VaultNote</td>
<td></td>
<td>The standard information note in which to find the definitions and notations.</td>
</tr>
<tr class="even">
<td>pipeline</td>
<td>TokenClassificationPipeline</td>
<td></td>
<td>The token classification pipeline that is used to predict whether tokens are part of definitions or notations introduced in the text.</td>
</tr>
<tr class="odd">
<td>excessive_space_threshold</td>
<td>int</td>
<td>2</td>
<td>remove_existing_def_and_notat_markings: bool = False, # If <code>True</code>, remove definition and notation markings (both via surrounding by double asterisks <code>**</code> as per the legacy method and via HTML tags)</td>
</tr>
<tr class="even">
<td>add_boxing_attr_to_existing_def_and_notat_markings</td>
<td>bool</td>
<td>True</td>
<td>If <code>True</code>, then nice attributes are added to the existing notation HTML tags, if not already present.</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>In the following examples, we mock pipeline objects instead of using actual ones.</p>
<p>In the below example, we run the <a href="https://hyunjongkimmath.github.io/trouver/markdown.obsidian.personal.machine_learning.tokenize.def_and_notat_token_classification.html#auto_mark_def_and_notats"><code>auto_mark_def_and_notats</code></a> function on a note that has double asterisks <code>**</code> surrounding parts of the text that introduced definitions or notations. In these cases, appropriate HTML tags replace the double asterisks instead.</p>
<div id="cell-56" class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> (tempfile.TemporaryDirectory(prefix<span class="op">=</span><span class="st">'temp_dir'</span>, <span class="bu">dir</span><span class="op">=</span>os.getcwd()) <span class="im">as</span> temp_dir,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>      mock.patch(<span class="st">'__main__.pipelines.token_classification.TokenClassificationPipeline'</span>) <span class="im">as</span> mock_pipeline):</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    temp_vault <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">'test_vault_6'</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    shutil.copytree(_test_directory() <span class="op">/</span> <span class="st">'test_vault_6'</span>, temp_vault)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    mock_pipeline.tokenizer.model_max_length <span class="op">=</span> <span class="dv">512</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    vn <span class="op">=</span> VaultNote(temp_vault, name<span class="op">=</span><span class="st">'reference_with_tag_labels_Definition 2'</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Text before:</span><span class="ch">\n\n</span><span class="st">"</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(vn.text())</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n\n\n</span><span class="st">Text after:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    auto_mark_def_and_notats(vn, mock_pipeline)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(vn.text())</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    mf <span class="op">=</span> MarkdownFile.from_vault_note(vn)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> mf.has_tag(<span class="st">'_auto/def_and_notat_identified'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Text before:


---
cssclass: clean-embeds
aliases: []
tags: [_meta/literature_note, _meta/definition, _meta/notation]
---
# Ring of integers modulo $n$[^1]

Let $n \geq 1$ be an integer. The **ring of integers modulo $n$**, denoted by **$\mathbb{Z}/n\mathbb{Z}$**, is, informally, the ring whose elements are represented by the integers with the understanding that $0$ and $n$ are equal.

More precisely, $\mathbb{Z}/n\mathbb{Z}$ has the elements $0,1,\ldots,n-1$.

...


# See Also
- [[reference_with_tag_labels_Exercise 1|reference_with_tag_labels_Z_nZ_is_a_ring]]
# Meta
## References

## Citations and Footnotes
[^1]: Kim, Definition 2



Text after:

---
cssclass: clean-embeds
aliases: []
tags: [_meta/notation, _auto/def_and_notat_identified, _meta/literature_note, _meta/definition]
---
# Ring of integers modulo $n$[^1]

Let $n \geq 1$ be an integer. The &lt;b definition="" style="border-width:1px;border-style:solid;padding:3px"&gt;ring of integers modulo $n$&lt;/b&gt;, denoted by &lt;span notation="" style="border-width:1px;border-style:solid;padding:3px"&gt;$\mathbb{Z}/n\mathbb{Z}$&lt;/span&gt;, is, informally, the ring whose elements are represented by the integers with the understanding that $0$ and $n$ are equal.

More precisely, $\mathbb{Z}/n\mathbb{Z}$ has the elements $0,1,\ldots,n-1$.

...


# See Also
- [[reference_with_tag_labels_Exercise 1|reference_with_tag_labels_Z_nZ_is_a_ring]]
# Meta
## References

## Citations and Footnotes
[^1]: Kim, Definition 2</code></pre>
</div>
</div>
<div id="cell-57" class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: more examples with pipeline mocking actual outputs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/hyunjongkimmath\.github\.io\/trouver");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/hyunjongkimmath/trouver/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>